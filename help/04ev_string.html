<!doctype html>
<html lang="ja">
<HEAD>
<meta charset="UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta name="GENERATOR" content="JustSystems Homepage Builder Version 22.0.5.0 for Windows">
<TITLE>文字列操作</TITLE><LINK rel="stylesheet" href="style.css">


<style>
body {
  margin: 0;
  display: flex;
  height: 100vh;
  overflow: hidden;
  font-family: sans-serif;
}
#menu-frame {
  width: 185px;
  min-width: 185px;
  max-width: 185px;
  border-right: 1px solid #aaa;
  height: 100%;
}
#content {
  flex-grow: 1;
  overflow-y: auto;
  padding: 16px;
}
iframe {
  width: 100%;
  height: 100%;
  border: none;
}
</style>
</HEAD>
<BODY>
<!-- 左：メニュー -->
<div id="menu-frame">
<iframe src="00_menu.html" title="メニュー"></iframe>
</div>
<!--ここから右欄-->
<div id="content" id="scroll-target">


<P><BR>イベントコマンド　<B><FONT size=+1>【文字列操作】</FONT></B><BR>
<BR>
　文字列変数を操作したり、キーボードからの文字入力を受け付けるコマンドです。<BR>
<BR>
<IMG src="Ev_string.png" border="0"><BR>
<BR>
<BR>
<B><FONT size=+1>【各部の説明】</FONT></B><BR>
<BR>
<BR>
<B>１．代入先の指定</B><BR>
　代入先の文字列変数を選択します。<BR>
　「代入先を変数で指定」する際は、通常/予備変数に3000000（文字列変数）以上の値を入れて使用してください。<BR>
<BR>
<BR>
<BR>
<B>2.代入方法</B><BR>
　代入先への代入方法です、次の4種類があります。ここでは、代入先を「左辺」、代入する文字列を「右辺」と呼ぶことにします。<BR>
<BR>
　「<B>＝</B>」 … 左辺に右辺をそのまま代入します。<br>
<BR>
　「<B>＋＝</B>」 … 左辺の文字列変数に右辺を追加します。<br>
<BR>
　「<B>上1行コピー</B>」 … 右辺の上1行だけ左辺に代入します。<br>
<BR>
　「<B>上1行切り取り(+↓文ｶｯﾄ)</B>」 … 右辺の上1行を切り取り、左辺に代入します。つまり、この処理を行うと右辺の上1行が消去されます。<br>
<BR>
　「<B>に↓から1文字切り出し(+↓文ｶｯﾄ)</B>」 … 右辺の先頭1文字を切り取り、左辺に代入します。この処理を行うと右辺の先頭1文字が消去されます。全角、半角共に対応しています。<BR>
　特殊文字の場合は特殊で、1回の処理で\A+なら「\A+」、\c[1]なら「\c[1]」分だけ抜き取ることができ、\r[X,A]など文字列が入る特殊文字の場合は「\r[」だけを抜き取ります。<br>
<br>　「<B>に↓から最後1文字切り出し(+↓文ｶｯﾄ)</B>」 … 右辺の最後1文字を切り取り、左辺に代入します。この処理を行うと右辺の最後の1文字が消去されます。全角、半角共に対応しています。特殊文字の場合も、「<b>に↓から1文字切り出し</b>」と同様です。<br>
<br>　「<B>に↓から指定文字まで切出(+↓文ｶｯﾄ)</B>」 … 「右辺」を「指定文字」まで切り出し、左辺の「文字列変数」に格納し、指定文字を除いた残った分を「右辺」に格納します（例：右辺の文字列変数に「あいうえお」が入っていて、それに対して指定文字「う」で切り出すと左辺に「あい」、右辺が「えお」になります）。<br>
　「指定文字」が見つからなかった場合は「左辺」に「<b><span style="color : #cc0000;">&lt;&lt;NotFound&gt;&gt;</span></b>」が格納され、「右辺」は「元のまま」となります。<span style="font-size : 80%;">(Ver3.607以降)</span><br>
　また、<b><span style="color : #cc0000;">右辺に「文字列変数」を指定していない場合はただの「切り出しのみ」の処理になります。　</span></b><br>
<span style="font-size : 80%;">　　→　他に「から指定文字まで切り出し」と「の指定文字以降を切り出し」の2コマンドがありますが、「に↓から指定文字まで切り出し(+↓文ｶｯﾄ)」はこの2コマンドを同じ文字列に対して1回で行える処理となります。</span><br>
<BR>
　「<B>に↓のファイル内容読込</B>」 … 右辺のファイル名のデータを読み込み、左辺の文字列変数に格納します。右辺には、「Data/test.txt」という具合に代入してください。<br>
<span style="color : #999999;">　　※読み込む文字コードを「UTF-8[標準]」「SJIS」「文字コード自動判別」から選択できます。よく分からなければ自動判別にしてください（Ver3.00より）。</span><BR>
　「<B>をファイル↓に出力</B>」 … 左辺の文字列変数の中身を、右辺のファイル名のデータに保存します。<br>
<span style="color : #999999;">　　※保存するフォーマットを「UTF-8/BOM有」と「UTF-8/BOMなし」から選べます。通常は「BOM有」で問題ありません。ウディタ上ではどちらでも読み込めますが、「BOM有」の方が読み込み処理が軽くて安全です。(Ver3.10より)</span><br>
　<span style="color : #999999;">※保存先文字列内に「//」「\\」「..」「./」「.\」「%」「:」「*」「?」「&quot;」「&lt;」「&gt;」「|」が含まれていると保存できませんので注意してください(Ver3.00より)</span><br>
<br>　「<B>に↓のファイルをBase64で読込</B>」 … 右辺のファイル名のデータを読み込み、Base64に変換して文字列変数に格納します。<br>
<span style="color : #999999;">　　※<b>Base64</b>：画像など、本来人間がテキスト情報として読めないバイナリデータを「a-z、A-Z、0-9」の64文字のデータに変換します。このBase64形式のデータは、もっぱらオンラインのデータ処理に使われます。</span><br>
<BR>
　「<B>に↓フォルダのファイルリスト取得</B>」 … 右辺に指定されたフォルダ内のファイル一覧を取得し、左辺に代入します。格納されるのは1ファイルにつき1行なので、各々のファイル名は「<B>上1行切り出し</B>」などを使用して取得してください。なお、<B>暗号化フォルダ</B>に対しては機能しません（&lt;&lt;ERROR&gt;&gt;が返されます）。<br>
<BR>
　「<B>から↓の文字列を全消去</B>」 … 左辺の文字列内から、右辺の文字列だけを全て消去します。（例：左辺が「あいうえお」のとき、「い」を全消去すると、左辺が「あうえお」となります）<br>
<br>
　「<B>に↓から特殊文字を消去して格納</B>」 … 左辺の文字列内から、右辺の文字列に含まれる特殊文字を全て消去します。フォント変更の\f[]などの特殊文字によって生まれた内部コードを全て削除します。\r[X,Y]のYY部分や\img[]指定も、「
] 」が終わる範囲まで消去されます。<br>
<BR>
　「<B>から以下の文字列を置換</B>」 … 右辺に2つの文字列欄がでてきます。左辺の文字列内から、左側の入力欄に入れられた文字列を右側の入力欄に入れられた文字列で置換します。（例：左辺が「あいうえお」の時、「え」を「お」で置換すると、左辺が「あいうおお」になります。コンマ区切り(CSV)のデータを読み込んだ際に、「,」を改行で置換して、1行切り出しで読み込みなどの用途に使えるかと思われます。）<BR>
　<img src="Ev_string2.png" border="1"><br>
<br>　「<B>から正規表現で置換</B>」 … 右辺に2つの文字列欄がでてきます。左辺文字列内に対し、1つめの正規表現で置換対象を指定し、2つめの文字列に変換できます。（例：左辺のS1に「人数400人」が格納されているとします。右辺の正規表現に「(\d{1,4})」
→ 「$1ですよ$1」と指定すると、S1には「人数400ですよ400人」という数値が返されます）<br>
<span style="font-size : 80%;">　　→　※「</span><b><span style="font-size : 80%;">正規表現</span></b><span style="font-size : 80%;">」内で\s[0]などの特殊文字を使う場合は&lt;&lt;&gt;&gt;で挟んでください(例：&lt;&lt;\s[0]&gt;&gt;など)。</span><br>
<span style="font-size : 80%;">　　　　　　&lt;&lt;&gt;&gt;部分は自動で消滅します(「&lt;&lt;」を文字として直接入れたい場合は「\&lt;\&lt;と」記入してください）。</span><BR>
<BR>
　「<B>から指定文字まで切り出し</B>」 … 左辺の文字列内から、入力欄に入れられた文字列までだけ切り出します（例：左辺が「あいうえお」のとき、「う」まで切り出すと左辺が「あい」になります）。指定した文字列が見つからない場合、「<B>&lt;&lt;NotFound&gt;&gt;</B>」を返します。<br>
<BR>
　「<B>の指定文字以降を切り出し</B>」 … 左辺の文字列内から、入力欄に入れられた文字列以降だけ切り出します（例：左辺が「あいうえお」のとき、「う」以降を切り出すと左辺が「えお」になります）。指定した文字列が見つからない場合、「<B>&lt;&lt;NotFound&gt;&gt;</B>」を返します。<br>
<br>
　「<B>から正規表現で()内を抽出</B>」 … 左辺の文字列内から、入力欄に入れられた「正規表現」の()内に該当する部分だけ切りて左辺に格納します。何も見つからない場合は空文字列が格納されます。（例：左辺のS1に「人数400人」が格納されているとき、正規表現で「人数(\d{1,4})人」と指定すると、(\d{1,4})部分に該当する「400」という数値だけS1に返されます）<br>
　→　※「<b>正規表現</b>」内で\s[0]などの特殊文字を使う場合は&lt;&lt;&gt;&gt;で挟んでください(例：&lt;&lt;\s[0]&gt;&gt;など)。<br>
　　　　&lt;&lt;&gt;&gt;部分は自動で消滅します(「&lt;&lt;」を文字として直接入れたい場合は「\&lt;\&lt;と」記入してください）。<br>
<BR>　「<B>隠しコード実行(&lt;&lt;から始まる）</B>」 … 右辺に入れたコードに従って、通常のコマンド指定ではできない、特殊な処理を実行できます。<b><a href="04ev_string_specialcode.html" target="B">隠しコードの一覧はこちら</a></b>です。<br>
<br>
<BR>
<BR>
<BR>
<B>３．代入する文字列</B><BR>
　代入する文字列は、次の4種類の方法で指定できます。<BR>
<BR>
・<B>手動入力</B> … 手動で文字を入力します。この入力には\v[?]や\s[?]といった特殊文字も使用可能です。<BR>
<BR>
・<B>文字列変数</B> … 他の文字列変数を読み込みます。<BR>
<BR>
・<B>ロード位置を変数で指定</B> … 「変数の値」の文字列変数を読みに行きます。たとえば読み込んだ変数値の値が3000002（文字列変数2番のコード）という風に格納されていれば、文字列変数2番を読みに行きます。<BR>
<BR>
・<B>キーボード入力</B> … プレイヤーにキーボードからの文字入力をうながします。キャンセル有りにするとEscキーで入力をキャンセルすることができます。なお、この文字入力には日本語も使用可能です。左辺を置換にチェックをすると、左辺に元から入っていた文字列が入力された状態で文字入力をさせることができます。<BR>
<FONT size="-1">　</FONT><FONT color="#ff0000" size="-1">※テストプレイ時に限り、『キーボード入力』中に「F7～F9キーなどのデバッグメニューを表示する」あるいは「F11キーで再読み込みする」と「<B> キーボード入力中の文字のサイズが変わってしまいます</B> 」が、文字サイズを設定するタイミングは「キーボード入力の開始時」のみなので、<B>この動作自体は仕様です</B>。(2017/3/7追加)</FONT><BR>
　※\は自動で文字の\に変換されるため、\self[0]などは変換できません。&lt;C&gt;、&lt;R&gt;、&lt;L&gt;は自動で消去されます。<BR>
<BR>
<BR>
<B>４．変数名の設定</B><BR>
　この欄で文字列変数に名前を付けたり、最大数を増やしたりすることができます。設定したい変数をプルダウンリストから選び、設定したい名前を入力したら「<B>設定</B>」ボタンを押してください。<BR>
　「<B>↓コピー</B>」ボタンは、プルダウンリストで選択中の文字列変数の名前を下にコピーします。<BR>　「<B>サイズ+1</B>」ボタンは、文字列変数の最大数を一つ増やします。<BR>
<BR>
<BR>


<HR>
<p><b>【隠し機能　自動キー入力でEnterを入れて「キーボード入力」を強制決定する】</b></p>
<p>　この「文字列操作」の「キーボード入力」中、並列イベントなどで「キー入力」コマンドの「自動キー入力」を使って「Enter（キーコード：128）」を入力すると、そこまで入力した分でキーボード入力が決定されます。<br>
　時間制限付きの文字入力イベントなどに使えるでしょう、。<br>
</p>
<HR>
<P><BR>
</P>
<P><BR>
</P>

</div>
</BODY>
</HTML>