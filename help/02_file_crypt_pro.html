<!doctype html>
<html lang="ja">
<HEAD>
<meta charset="UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta name="GENERATOR" content="JustSystems Homepage Builder Version 22.0.5.0 for Windows">
<TITLE>[P]ファイル個別暗号化</TITLE><LINK rel="stylesheet" href="style.css">


<style>
<!--

body{
  margin: 0;
  display: flex;
  height: 100vh;
  overflow: hidden;
  font-family: sans-serif;
}
#menu-frame{
  width: 185px;
  min-width: 185px;
  max-width: 185px;
  border-right: 1px solid #aaa;
  height: 100%;
}
#content{
  flex-grow: 1;
  overflow-y: auto;
  padding: 16px;
}
iframe{
  width: 100%;
  height: 100%;
  border: none;
}
-->
</style>
</HEAD>
<BODY>
<!-- 左：メニュー -->
<div id="menu-frame">
<iframe src="00_menu.html" title="メニュー"></iframe>
</div>
<!--ここから右欄-->
<div id="content" id="scroll-target">


<P><BR>
<B><FONT size="+1">【[P]ファイル個別暗号化】</FONT></B> プロ版のみの個別ファイル暗号化機能<BR>
<BR>
　プロ版では、ファイル1つ1つに個別のキーを設定して暗号化することができます。<br>
　画像だけでなく、「<b>フォント</b>」や「<b>マップファイル(.mps)</b>」の暗号化も可能です。<br>
<br>
　これは「ゲームデータ作成」時の暗号化によるセキュリティには限界があることが分かったため、「<b>ユーザーごとに異なる方法でファイル別暗号化をおこなえるようにする</b>」ために搭載されたものです。<br>
<span style="color : #cc0000;">　この機能でしっかりキー設定して作られた「.wolfx」暗号化ファイルは、「ゲームデータ作成」時の暗号化で作られたものに比べて、解析や解凍がはるかに困難になります。<br>
</span><span style="font-size : 80%;
	color : #cc0000;
">（最低でも、コモンイベント内やマップファイル内を詳しく解析しないと、復号するためのキーが分からなくなります。さらにゲーム内で、キー文字列の作り方を分かりにくくしたり、オンライン経由でキーをダウンロードして使用後にすぐキーをリセットするようにすれば、ゲームデータ全体を解析しても復号キーを知ることは非常に難しくなります）</span><br>
<hr size="1" id="standard">
<BR>
<IMG src="02_file_crypt_pro.png" border="0" style="width:95%; max-width:478px;"><BR>
<p><b><span style="font-size : 120%;">●ウィンドウ内に</span><span style="font-size : 120%;
	color : #cc0000;
">ファイルをドラッグ&amp;ドロップ</span><span style="font-size : 120%;">すると暗号化できます</span></b><br>
　暗号化やそれを読み込む手順は以下の通りです。<br>
<br>
　1．<b>「復号キー」「文字列キー」「数値キー」</b>の3つを設定する（何も設定しなくてもOK）<br>
<br>
　2．暗号化したいファイルを「エクスプローラー(Windows付属ツール)」などからこのウィンドウへ<b>ドラッグ&amp;ドロップする</b>（マウスカーソルで引っ張ってウィンドウ内に入れる）ことで、「<b><span style="color : #cc0000;">そのファイルと同じフォルダ</span></b>」内に<b>.wolfx暗号化</b>されたファイルが出力されます（例えばChicken.pngを暗号化すると、同フォルダにChichen.png.wolfxが出力されます）。<br>
<br>
　3．[ゲーム内] ゲーム内で各キーを正しく設定すれば、個別暗号化された.wolfxファイルを読み込むことができます。<br>
　　（個別暗号化したファイルがある場合、元ファイルを指定しても暗号化した方が優先して読み込まれます）<br>
<br>
<br>
<br>
<b><span style="font-size : 120%;">●「まとめて再暗号化」機能について</span></b><br>
　ゲームデータ内に作られているすべての.wolfxを探し、「<b>更新日時</b>」が元のファイルより古かった暗号化ファイル（=元ファイルの方が暗号化ファイル側より新しくなっているもの）を、「<b>まとめて再暗号化</b>」できます。<br>
　ただし、再暗号化できるのは「<b>履歴に暗号化の記録が残っている</b>」ものに限られます。通常、暗号化を行うと自動で履歴に残るため、ほとんどの場合は問題は起きないはずです。<br>
<br>
<br>
<br>
<b><span style="font-size : 120%;">●暗号化されたファイルの、ゲーム内での読み込み方</span></b><br>
<br>
　この暗号化を行ったファイルはゲーム中、<br>
<b>　- 「</b>(「<a href="04ev_pro_command.html" target="B">プロ版機能</a>」でセットできる)<b>復号キー」、<br>
　- 「</b>指定した<b>文字列変数と、文字列キー」<br>
　- 「</b>指定した<b>数値変数と、数値キー」</b><br>
　の3つが、<b>読み込みの瞬間に一致している</b>場合だけ、ゲーム内から正常に読み込むことが可能になります。違う場合は緑帯のエラーが表示されます。<br>
　この3つのうちのいくつか、あるいは全てを使わないようにすることも可能です。<br>
　（全てを使わない場合、直接Windows上から読めないだけで、GamePro.exeからは何もキー設定しなくても読めるファイルになります。解析にはおそらく無力になります）<br>
<br>
<br>
<br>
<b><span style="font-size : 120%;">【.wolfxファイルがある場合、エディター内で元ファイルを指定しても、ゲーム中は優先的に.wolfx暗号化ファイルが読み込まれます】</span></b><br>
　ゲーム中に元ファイルが読み込まれようとしたとき、もしそのファイルの「.wolfx」版ファイルがあれば優先的に.wolfx暗号化ファイルの方が読み込まれます。<br>
<br>
　たとえば「CharaChip」フォルダ内に「Chicken.png」があり、それを個別ファイル暗号化して「Chicken.png.wolfx」ファイルを作ったとします。<br>
　この場合、ゲーム内で「<b>CharaChip/Chicken.png</b>」ファイルを読み込もうとすると、自動で「<b>CharaChip/Chicken.png.wolfx</b>」ファイルが読み込まれるのです。<br>
<br>
　つまり<b><span style="color : #cc0000;">.wolfx暗号化ファイルが作られている場合はエディター側で「元ファイル」をファイル指定したままでも、ゲームのプレイ中には「自動で暗号化ファイルの方を読み込んでくれる」</span></b>のです。元ファイルを入れたままでも、本番同様にテストプレイができるというわけです。<br>
　→　逆に言うと、.wolfx暗号化ファイルが作られているファイルの場合、どうやってもゲーム中に元ファイルの方を読み込みさせることはできません。元ファイルを読ませたい場合は.wolfxファイルを削除してください。<br>
<br>
<br>
<br>
<b><span style="font-size : 120%;">【ゲームデータ作成時、.wolfxファイルが作られているときは元ファイルはゲームデータにコピーされません】</span></b><br>
　「CharaChip」フォルダ内に「<b>Chicken.png</b>」と、それを暗号化した「<b>Chicken.png.wolfx</b>」ファイルがあった場合、「ゲームデータ作成」を行うと、「<b>Chicken.png.wolfx</b>」のみコピーされ、元の「<b>Chicken.png</b>」はコピーされません。<br>
　よって、<span style="color : #cc0000;">ゲームデータを作成する際に、いちいち元ファイルを消す必要はありません。</span><br>
<br>
<br>
<br>
<b><span style="font-size : 120%;">【ゲーム中にキーを設定して読み込ませます】</span></b><br>
　- ゲーム中、「プロ版機能」内の「<b>.wolfx暗号化ファイルの復号キーをセット</b>」コマンドを使うことで、「指定ファイル」に対して「<b>復号キー</b>」をセットできます。<br>
<br>
　- <b>「文字列変数/数値変数」</b>のキーを設定していた場合は、ゲーム中の読み込み時にそれらも一致する必要があります。<br>
　　たとえば文字列キーで「<b>S1:シーン名</b>」が「<b>魔法使いとの出会い</b>」の場合、とキー指定した場合、もしゲーム中にS1の内容が「<b>旅立ち</b>」（魔法使いとの出会い、ではない）だったりした場合は<b>復号に失敗</b>します。<br>
　　→　これはたとえば、1枚絵ファイルが使われる 「シーン名」や「章番号」をキーとしてセットして暗号化画像を読ませたりすることを想定しています。<br>
<br>
<br>
<br>
<b><span style="font-size : 120%;">【セットした「復号キー」はセーブデータ内に保存されます】</span></b><br>
　ゲーム中にセットした「<b>復号キー</b>」はセーブデータ内に保存されます。<br>
　ファイルを守る目的ではおすすめしませんが、「<b>ゲーム開始時</b>」に<b>ファイルやフォルダ別の復号キーを一通りセット</b>しておけば、以後、特に「復号キー」を意識せずにファイルを扱うことが可能になるでしょう。<br>
<span style="color : #cc0000;">（一方、もしファイルを強力に守りたい場合は、<br>
　「<b>様々な場所で数文字ずつキーを追記して復号キーを作る（解析を難しくする）</b>」<br>
　「<b>復号キーをオンラインからダウンロードして使用後にすぐ消す（セーブデータに残さない）</b>」<br>
　などすると解析が非常に難しくなるため、ファイルのセキュリティが向上します）</span><br>
<br>
<br>
<br>
<b><span style="font-size : 120%;">【暗号化可能なファイル形式】</span></b><br>
- <b>txt、png、ogg、mps（マップファイル）</b>など、ゲーム中にイベントコマンド経由で読み込まれる多くのファイル形式を暗号化することができます。<br>
　なお、「<b>.dat</b>」ファイル、「<b>.project</b>」ファイルは暗号化できません。<b><span style="color : #cc0000;">ゲーム基本設定(Game.dat)、コモンイベント、タイルセット設定、データベースファイルは暗号化できない</span></b>ということです。<br>
 　<br>
- <b><span>ttf/ttc/otf</span></b> 形式の「<b>フォントファイル</b>」も暗号化できますが、<b><span style="color : #cc0000;">キーは何も設定できません。</span></b><br>
　(フォントは「起動時に自動で読み込まれる」ため、ゲーム内から復号キー等が設定できないからです。フォントファイルは、「Game.exeと同じ場所」あるいは「Dataフォルダ内」に暗号化した「～.ttf.wolfx」フォントなどを置いておくと自動で読み込まれます)<br>
<br>
<br>
<br>
<b><span style="font-size : 120%;">【mps(マップ)ファイルに.wolfx暗号化ファイルが作られていた場合、マップ保存時に暗号化ファイルも自動保存されます】</span></b><br>
　マップファイルが保存された時、もし<b><span style="color : #cc0000;">そのマップファイルの「.wolfx」版ファイルがあった場合は自動で再暗号化も行います</span></b>。でないとテストプレイが大変になるためです。<br>
　(ただし個別ファイル暗号化の「履歴」内にそのマップファイルの暗号化情報がある場合のみ、再暗号化されます）<br>
</p>
<p><br>
  
  <hr>
  <p><br>
  <b><span style="font-size : 150%;">●セキュリティの高め方</span></b><br>
  <br>
  　この「個別ファイル暗号化」機能を使って高いセキュリティを発揮するには、以下の方法がおすすめです。<br>
  <br>
  <br>
  <b><span style="font-size : 120%;">【暗号化時】</span></b><br>
  <br>
  　- 復号キーを長めにしておく。日本語20文字など。<br>
  <br>
  <br>
  <br>
  <b><span style="font-size : 120%;">【復号化時（ゲーム内の、コモンイベントやマップイベント内での処理）】</span></b><br>
  <br>
  　- <b>【基本的な注意】</b><br>
  <br>
  　　・「<b>プロ版機能</b>」の「<b>復号キーをセット」</b>コマンドには<b><span style="color : #cc0000;">直接、復号キーを書かない。</span></b><br>
  　　　→　コマンド解析で一発でキーがバレてしまいます。最低でも、「\s[1]\v[4]」のように代入特殊文字を使って指定しましょう。<br>
  <br>
  　　・基本的には、関連文字列をちりぢりにしておいて、『<b><span style="color : #cc0000;">（コマンドだけを見ても分からず）実際にゲームを動かさないと完成された復号キーが分からない</span></b>』仕組みにすればするほどセキュリティが高くなります。<br>
  <br>
  <br>
  <br>
  　- <b>【復号キーの作り方1　数文字ずつ足したり消したりする】</b><br>
  　　「文字列操作」で<b><span style="color : #cc0000;">数文字ずつ足したり消したり</span></b>して復号キーを作る。<br>
  　　　→　さらにその処理をちりぢりのマップイベントに入れ、「順路にしたがって1文字ずつ追加されていく」ようにすると解析は非常に困難になります。<br>
  　　　　通常、マップ上のプレイヤーの移動経路まで把握することは自動解析処理では困難だからです。<br>
  <br>
  <br>
  　- <b>【復号キーの作り方2　一見ランダムな順番で作る】</b><br>
  　　マップイベントにちりぢりに配置するのが面倒な場合、コモンイベント内で以下のように<br>
  　　　1. Sys110で固定のシード値をセットしてから<br>
  　　　2. ランダムな順番で文字を作ったり消したりする処理を作る<br>
  　　という方法で解析を困難にすることができます。<br>
  <br>
  　　「シード値を固定の値」にすると、その直後からのランダム値は実は「同じ数値列」が出てくるので、この仕組みを利用すれば「<b>必ず同じ文字列を作ることができる</b>」のです。<br>
  　　以下のコマンド例では、シードを「7」にセットした後の「変数操作: CSelf0 = 0 ～ 3 」は「1」「3」「0」「1」「1」の順に値を返すので、「あいい（最初あったはずの「い(1)」は「1文字削除(3)」で相殺）」という文字列が生成されます。<br>
  　　
  <blockquote style="border:1px solid #ccf; padding:5px;"><br>
  <span style="font-size : 80%;">■変数操作: </span><b><span style="font-size : 80%;">Sys110:現在の乱数のシード(種) = 7</span></b><span style="font-size : 80%;"> + 0 </span><br>
  <span style="font-size : 80%;">■文字列操作：CSelf5 = &quot;&quot;</span><br>
  <span style="font-size : 80%;">■回数付きループ [ 5 ]回</span><br>
  <span style="font-size : 80%;">|■変数操作: CSelf0 = 0 ～ 3 </span><br>
  <span style="font-size : 80%;">|■条件分岐(数値):  【1】 CSelf0  が   0 と同じ  【2】 CSelf0  が   1 と同じ  【3】 CSelf0  が   2 と同じ  【4】 CSelf0  が   3 と同じ </span><br>
  <span style="font-size : 80%;">|-◇分岐： 【1】  [ CSelf0  が  0 と同じ  ]の場合↓</span><br>
  <span style="font-size : 80%;">| |■文字列操作：CSelf5 += &quot;あ&quot;</span><br>
  <span style="font-size : 80%;">| |■</span><br>
  <span style="font-size : 80%;">|-◇分岐： 【2】  [ CSelf0  が  1 と同じ  ]の場合↓</span><br>
  <span style="font-size : 80%;">| |■文字列操作：CSelf5 += &quot;い&quot;</span><br>
  <span style="font-size : 80%;">| |■</span><br>
  <span style="font-size : 80%;">|-◇分岐： 【3】  [ CSelf0  が  2 と同じ  ]の場合↓</span><br>
  <span style="font-size : 80%;">| |■文字列操作：CSelf5 += &quot;う&quot;</span><br>
  <span style="font-size : 80%;">| |■</span><br>
  <span style="font-size : 80%;">|-◇分岐： 【4】  [ CSelf0  が  3 と同じ  ]の場合↓</span><br>
  <span style="font-size : 80%;">| |■文字列操作：CSelf6 =&lt;最後1文字切出(→文ｶｯﾄ)&gt;CSelf5</span><br>
  <span style="font-size : 80%;">| |■</span><br>
  <span style="font-size : 80%;">|◇分岐終了◇</span><br>
  <span style="font-size : 80%;">|■</span><br>
  <span style="font-size : 80%;">◇ループここまで◇◇</span><br>
  <span style="font-size : 80%;">▼ この時点で\cself[5]には「あいい」という文字列が格納されている</span><br>
  <span style="font-size : 80%;">■[Pro] .wolfx暗号化ﾌｧｲﾙの復号ｷｰをｾｯﾄ [Data/Animal_Chicken.png] =&gt; [</span><b><span style="font-size : 80%;">\cself[5]</span></b><span style="font-size : 80%;">]</span><br>
  </blockquote>
  <br>
  <br>
  　- <b>【復号キーの作り方3　オンラインからダウンロードする】</b><br>
  　　復号キーのtxtファイルをレンタルサーバーなどに置いておいて、ゲーム中に『ダウンロード』処理で文字列として取得して復号キーにすることで、『<b>配布されているゲームデータを解析するだけでは復号キーが分からない</b>』という状態にできます。<br>
  　　その場合、<b>URLも</b>何回かの文字列操作で「<b>文字列を組み合わせて作る</b>」のがより効果的です。<br>
  　　<br>
  <br>
  <br>
  <br>
  　以上の方法はあくまで一例です。<br>
  　ここに書いてある時点ですでに自動解析処理として対応されている可能性がありますので、みなさまそれぞれに独創的なセキュリティを作ったり、アレンジしてご利用いただくと、ファイルをより強固に守ることができるでしょう。<br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <BR>
</p>

</div>
</BODY>
</HTML>